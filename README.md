# Fluid

Это ДЗ №2 студента группы БПИ232, Кошкина Георгия Андреевича

В корневой директории есть несколько папок, Makefile, входной файл с начальными данными для симулятора и main.cpp. Основные команды Makefile-а:
    - make <аргументы мейка>
    В качестве аргументов мейка можно передать ему все необходимые параметры:
        1) TYPE1, TYPE2, TYPE3 - типы --p-type, --v-type и --v-flow-type соответственно 
        2) IN_FILE - откуда считывать, по умолчанию in.bin
        3) SAVE_INDEX - какое по счету сохранение загрузить из IN_FILE. Если SAVE_INDEX больше, чем существующее количество записей в IN_FILE, программа выдаст ошибку.
        4) STORAGE_FILE - куда сохранять промежуточные состояния, по умолчанию storage.bin
        5) SAVE_FREQUENCY - с какой частотой делать сохранения состояния симуляции
        (сохранение происходит каждые SAVE_FREQUENCY тиков). При SAVE_FREQUENCY = 0 сохранение не будет производиться никогда 
        6) TYPES - какие типы передать при компиляции проекта. По умолчанию передаются TYPE1 TYPE2 TYPE3
        7) SIZES - какие размеры поля передать

    Пример: make TYPE1="DOUBLE" TYPE2="FAST_FIXED(53,11)" TYPE3="FIXED(64,43)" IN_FILE="storage.bin" SAVE_INDEX="37" STORAGE="storage2.bin" 

Этот вызов скомпилирует программу для таких типов, запустит, откроет storage.bin, найдет там 37 по счёту запись (отсчёт с нуля), начнет симуляцию с этого положения, попутно сохраняя свои состояния в файл storage2.bin через каждые save_frequency тиков

- make clear
  Подчищает корневую папку, удаляя объектные файлы и исполняемые файлы

- make fluid
  См. Additional

- make load-bin
   См. Additional

Теперь расскажу о структуре проекта:

1) папка Additional. Здесь расположены всякие периферийные файлы, существование которых не критично для проекта, но они могут упростить процесс разработки/проверки. Из основного: 
    - in_helper.cpp. Это маленькая утилита, которая позволяет обновить входной файл in.bin. Если хочется прогнать программу через какие-то другие тесты, то можно открыть in_helper.cpp, заменить поля на необходимые и запустить из корневой директории команду make load-bin

    - fluid.cpp Изначальная версия fluid2.cpp, которую прикрепили ко второй домашке. Если хочется сравнить скорость с формате было/стало, то изначальную версию можно посмотреть по команде make fluid

    - fluid-2.pdf Это ТЗ.

2) папка bin. Это папка, куда можно скидывать скомпилированные программы.

3) папка Templates. В этой папке расположен основной код проекта. В частности:
    - Types.h. Здесь можно посмотреть, как я определил типа Fixed, Fast_Fixed, Float и Double.

    - TypeInfo.h. Здесь расположен вспомогательный шаблонный класс TypeInfo, метод которого TypeInfo<Type>::name() играет важную роль на этапе разрешения типов.

    - Contains.h. Вспомогательный шаблонный класс, реализующий логику 
    container.contains(item), но для шаблонов и в Compile-Time
 
    - Imitation.h. Здесь расположен код из fluid.cpp, но обобщенный на разный размер и типы --p-type, --v-type, --v-flow-type. На этапе компиляции моя программа инстанцирует все возможные варианта шаблона Imitation, опираясь на переданные во время компиляции TYPES и SIZES, а потом на этапе исполнения вызывает нужную предкомпилированную версию.

    - Switch.h. Это аналог switch, но для типов и в Compile-Time. Этот шаблон играет ключевую роль при разрешении типов, когда пользователь в рантайме задает параметры --p-type, --v-type, --v-flow-type, --in-file, и программе надо принять решение, какую из предкомпилированных версий Imitation надо вызвать. 

    - State.h. Это структурка, которая описывает текущее состояние симуляции. Для нее определены операции записи в файл, считывания из файла, получение размера структуры и move-конструктор
